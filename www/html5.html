<html>
    <head>
        <title>witgap</title>
        <meta name="description" content="..."/>
        <meta name="keywords" content="ASCII,online,game,sandbox,MMO"/>
        <meta name="author" content="Andrzej Kapolka"/>
    </head>

    <body style="background-color: #000000;" onload="init()">
        <canvas width="800" height="600" id="canvas"/>

        <script type="text/javascript">
            var ctx;
            var charWidth, charHeight;
            var width, height;
            var offsetX, offsetY;
            var bitmapData = Object();
            var socket;

            function init () {
                var canvas = document.getElementById("canvas");
                ctx = canvas.getContext("2d");
                ctx.font = "12px Courier";
                ctx.fillStyle = "#00FF00";
                ctx.textAlign = "left";
                ctx.textBaseline = "top";
                charWidth = ctx.measureText("A").width;
                charHeight = 12;
                width = Math.floor(canvas.width / charWidth);
                height = Math.floor(canvas.height / charHeight);
                offsetX = Math.round((canvas.width % charWidth) / 2);
                offsetY = Math.round((canvas.height % charHeight) / 2);

                document.onkeydown = function (event) {
                };
                document.onkeyup = function (event) {
                };

                if ("WebSocket" in window) {
                    socket = new WebSocket("ws://localhost:8080/client");
                } else if ("MozWebSocket" in window) {
                    socket = new MozWebSocket("ws://localhost:8080/client");
                }
                socket.onopen = function () {
                };
                socket.onerror = function () {
                    fatalError("No connection to server.  Please wait a moment, " +
                        "then reload the page.");
                };
                socket.onmessage = function (event) {
                };
            }
            function fatalError (text) {
                addClientWindow(Number.MAX_VALUE, text);
            }
            function addClientWindow (id, text) {
                text = " " + text + " ";

                updateDisplay();
            }
            function updateDisplay () {

            }
            function drawCharacter (x, y, value) {
                var px = offsetX + x*charWidth;
                var py = offsetY + y*charHeight;
                var data = bitmapData[value];
                if (data) {
                    ctx.putImageData(data, px, py);
                    return;
                }
                ctx.clearRect(px, py, charWidth, charHeight);
                ctx.fillText(String.fromCharCode(value & 0xFFFF), px, py);
                bitmapData[value] = ctx.getImageData(px, py, charWidth, charHeight);
            }
            function setCookie (key, value) {
                var expires = new Date();
                expires.setFullYear(expires.getFullYear() + 5);
                document.cookie = key + "=" + escape(value) + "; expires=" + expires.toUTCString();
            }
            function getCookie (key, def) {
                var cookie = document.cookie;
                var values = cookie.split(";");
                for (ii = 0; ii < values.length; ii++) {
                    var value = values[ii];
                    var idx = value.indexOf("=");
                    if (value.substring(0, idx).replace(/\s+/, "") == key) {
                        return unescape(value.substring(idx + 1));
                    }
                }
                return def;
            }
            function getQtKeyCode (event) {
                switch (event.keyCode) {
                    case 27: return 0x01000000;
                    case 112: return 0x01000030;
                    case 113: return 0x01000031;
                    case 114: return 0x01000032;
                    case 115: return 0x01000033;
                    case 116: return 0x01000034;
                    case 117: return 0x01000035;
                    case 118: return 0x01000036;
                    case 119: return 0x01000037;
                    case 120: return 0x01000038;
                    case 121: return 0x01000039;
                    case 122: return 0x0100003a;
                    case 123: return 0x0100003b;
                    case 124: return 0x0100003c;
                    case 125: return 0x0100003d;
                    case 126: return 0x0100003e;
                    case 44: return 0x01000009;
                    case 145: return 0x01000026;
                    case 19: return 0x01000008;

                    case 192: return 0x60;
                    case 48: return 0x30;
                    case 49: return 0x31;
                    case 50: return 0x32;
                    case 51: return 0x33;
                    case 52: return 0x34;
                    case 53: return 0x35;
                    case 54: return 0x36;
                    case 55: return 0x37;
                    case 56: return 0x38;
                    case 57: return 0x39;
                    case 189: return 0x2d;
                    case 187: return 0x3d;
                    case 8: return 0x01000003;
                    case 45: return 0x01000006;
                    case 36: return 0x01000010;
                    case 33: return 0x01000016;
                    case 111: return 0x2f;
                    case 106: return 0x2a;
                    case 109: return 0x2d;

                    case 9: return 0x01000001;
                    case 81: return 0x51;
                    case 87: return 0x57;
                    case 69: return 0x45;
                    case 82: return 0x52;
                    case 84: return 0x54;
                    case 89: return 0x59;
                    case 85: return 0x55;
                    case 73: return 0x49;
                    case 79: return 0x4f;
                    case 80: return 0x50;
                    case 219: return 0x5b;
                    case 221: return 0x5d;
                    case 220: return 0x5c;
                    case 46: return 0x01000007;
                    case 35: return 0x01000011;
                    case 34: return 0x01000017;
                    case 103: return 0x37;
                    case 104: return 0x38;
                    case 105: return 0x39;
                    case 107: return 0x2b;

                    case 20: return 0x01000024;
                    case 65: return 0x41;
                    case 83: return 0x53;
                    case 68: return 0x44;
                    case 70: return 0x46;
                    case 71: return 0x47;
                    case 72: return 0x48;
                    case 74: return 0x4a;
                    case 75: return 0x4b;
                    case 76: return 0x4c;
                    case 186: return 0x3b;
                    case 222: return 0x27;
                    case 13: return 0x01000004;
                    case 100: return 0x34;
                    case 101: return 0x35;
                    case 102: return 0x36;

                    case 16: return 0x01000020;
                    case 90: return 0x5a;
                    case 88: return 0x58;
                    case 67: return 0x43;
                    case 86: return 0x56;
                    case 66: return 0x42;
                    case 78: return 0x4e;
                    case 77: return 0x4d;
                    case 188: return 0x2c;
                    case 190: return 0x2e;
                    case 191: return 0x2f;
                    case 38: return 0x01000013;
                    case 97: return 0x31;
                    case 98: return 0x32;
                    case 99: return 0x33;

                    case 17: return 0x01000021;
                    case 224: return 0x01000021;
                    case 18: return 0x01000023;
                    case 32: return 0x20;
                    case 93: return 0x01000055;
                    case 37: return 0x01000012;
                    case 40: return 0x01000015;
                    case 39: return 0x01000014;

                    default: return 0x01ffffff;
                }
            }
        </script>
    </body>
</html>
